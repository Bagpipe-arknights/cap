<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Account Settings</title>
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style2.css') }}">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .home-button {
            position: fixed; /* Make the button stay at the same place even when the page is scrolled */
            top: 10px;       /* 10px from the top of the page */
            left: 10px;     /* 10px from the right of the page */
        }
    </style>
</head>
<body>
	<!-- Button to go to the home page -->
	<button class="home-button" onclick="location.href='{{ url_for('index') }}'">
		Back to main page
	</button>
	<section class="py-5 my-5">
		<div class="container">
			<h1 class="mb-5">Account Settings</h1>
			<div class="bg-white shadow rounded-lg d-block d-sm-flex">
				<div class="profile-tab-nav border-right">
					<div class="p-4">
						<div class="img-circle text-center mb-3">
							<img src="{{ url_for('static', filename='img/Avartar.png') }}" alt="Image" class="shadow">
						</div>
						<h4 class="text-center"></h4>
					</div>
					<div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
						<a class="nav-link active" id="account-tab" data-toggle="pill" href="#account" role="tab" aria-controls="account" aria-selected="true">
							<i class="fa fa-home text-center mr-1"></i> 
							Account
						</a>
						<a class="nav-link" id="password-tab" data-toggle="pill" href="#password" role="tab" aria-controls="password" aria-selected="false">
							<i class="fa fa-key text-center mr-1"></i> 
							Password
						</a>
						<a class="nav-link" id="payment-tab" data-toggle="pill" href="#payment" role="tab" aria-controls="payment" aria-selected="false">
							<i class="fa fa-user text-center mr-1"></i> 
							Payment
						</a>
						<a class="nav-link" id="history-tab" data-toggle="pill" href="#history" role="tab" aria-controls="history" aria-selected="false">
							<i class="fa fa-book text-center mr-1"></i>
							History
						</a>
						
					</div>
				</div>
				<div class="tab-content p-4 p-md-5" id="v-pills-tabContent">
					<div class="tab-pane fade show active" id="account" role="tabpanel" aria-labelledby="account-tab">
						<h3 class="mb-4">Account Settings</h3>
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
								  	<label>First Name</label>
								  	<input type="text" class="form-control" value="{{ current_user.first_name }}">
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
								  	<label>Last Name</label>
								  	<input type="text" class="form-control" value="{{ current_user.last_name }}" >
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
								  	<label>Email</label>
								  	<input type="text" class="form-control" value="{{ current_user.email }}">
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
								  	<label>Phone number</label>
								  	<input type="text" class="form-control" value="{{ current_user.phone }}">
								</div>
							</div>
						
						</div>
						<div>
							<form action="/update" method="post">
								<!-- 其他的输入框，例如上述的 first_name, last_name, email, 和 phone_number -->
								<button class="btn btn-primary" type="submit">Update</button>
							</form>
						
						</div>
					</div>
					<div class="tab-pane fade" id="password" role="tabpanel" aria-labelledby="password-tab">
						<h3 class="mb-4">Password Settings</h3>
						<form method="POST" action="/update_password">
							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label>Old password</label>
										<input type="password" class="form-control" name="old_password">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label>New password</label>
										<input type="password" class="form-control" name="new_password">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label>Confirm new password</label>
										<input type="password" class="form-control" name="confirm_password">
									</div>
								</div>
							</div>
							<div>
								<button type="submit" class="btn btn-primary" name="update">Update</button>
							</div>
						</form>
					</div>
					
					<div class="tab-pane fade" id="payment" role="tabpanel" aria-labelledby="payment-tab">
						<h3 class="mb-4">Payment</h3>
						<hr class="my-4">
						<div class="row gy-3">
							<div class="col-md-6">
								<label for="cc-name" class="form-label">Name on card</label>
								<input type="text" class="form-control" id="cc-name" placeholder="Full Name">
							</div>
							<div class="col-md-6">
								<label for="cc-number" class="from-label">Credit card number</label>
								<input type="text" class="form-control" id="cc-number" placeholder="xxxx xxxx xxxx xxxx" maxlength="16"> 
							</div>
							<div class="col-md-3">
								<label for="cc-expiration" class="form-label">Expiration</label>
								<input type="text" class="form-control" id="cc-expiration" placeholder="MM/YY" maxlength="5">
							</div>
							<div class="col-md-3">
								<label for="cc-cvv" class="form-label">CVV</label>
								<input type="text" class="form-control" id="cc-cvv" maxlength="3" placeholder="3 Digit Number">
							  </div>
						</div>
						<hr class="my-4">
						<div>
							<button class="btn btn-primary">Save</button>
							<button class="btn btn-light">Update</button>
						</div>
					</div>

					<div class="tab-pane" id="history" role="tabpanel" aria-labelledby="history-tab">
						<h3 class="mb-4">Search History</h3>
						<div class="h5" id="username"></div>
						<div></div>
			
						<table class="table" id="history_table">
							<thead>
								<tr>
									<th scope="col">#</th>
									<th scope="col">Product</th>
									<th scope="col">timestamp</th>
								</tr>
							</thead>
							<tbody>
								<!-- 这里的行将由JavaScript动态生成 -->
							</tbody>
						</table>
					</div>
			
					<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
					<script>
					$(document).ready(function() {
							var user_id = {{ user_id }};  // 从Flask模板传递的用户ID

							$.get("/search_history/" + user_id, function(data) {
								var history = data.history;
								var tableBody = $('#history_table > tbody');
								tableBody.empty();  // 清空表格

								for (var i = 0; i < history.length; i++) {
									var record = history[i];
									var row = $('<tr>').append(
										$('<th>').text(i + 1),
										$('<td>').text(record.search_term),
										$('<td>').text(record.timestamp)
									);

									tableBody.append(row);
								}
							});
						});
					</script>
				
					
					
				</div>
			</div>
		</div>
	</section>



	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</body>
</html>